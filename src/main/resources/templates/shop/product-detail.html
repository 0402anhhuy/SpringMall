<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <title th:text="${product.name} + ' - FoodMart'">Sản phẩm - FoodMart</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" th:content="'Mua ' + ${product.name} + ' tại FoodMart. Sản phẩm chất lượng cao với giao hàng nhanh chóng.'" />

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/base.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/utilities.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/components.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/layout.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/product.css}" />
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet" />
  </head>
  <body>
    <!-- Header -->
    <div th:replace="~{fragments/header :: header}"></div>

    <!-- Breadcrumb -->
    <section class="breadcrumb-section">
      <div class="container">
        <nav class="breadcrumb-nav">
          <a th:href="@{/}" class="breadcrumb-link">Trang chủ</a>
          <span class="breadcrumb-separator">/</span>
          <a th:href="@{/shop}" class="breadcrumb-link">Cửa hàng</a>
          <span class="breadcrumb-separator">/</span>
          <a th:href="@{'/shop/category/' + ${product.category.id}}" class="breadcrumb-link" th:text="${product.category.name}">Danh mục</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current" th:text="${product.name}">Sản phẩm</span>
        </nav>
      </div>
    </section>

    <!-- Product Detail -->
    <section class="product-detail-section">
      <div class="container">
        <div class="product-detail-layout">
          <!-- Product Images -->
          <div class="product-images">\
            <div class="product-gallery">
              <div class="thumbnail-list">
                <div class="thumbnail-item active">
                  <img th:src="@{${product.image}}" alt="Product Image 1" class="thumbnail-img">
                </div>
<!--                <div class="thumbnail-item" th:each="image, iterStat : ${product.additionalImages}">-->
<!--                  <img th:src="@{${image}}" th:alt="'Product Image ' + ${iterStat.count + 1}" class="thumbnail-img">-->
<!--                </div>-->
              </div>
              <div class="main-image">
                <img th:src="@{${product.image}}" th:alt="${product.name}" class="main-product-img" id="mainProductImage">
              </div>
            </div>
          </div>

          <!-- Product Info -->
          <div class="product-info">
            <div class="product-badges">
<!--              <span class="product-badge fresh" th:if="${product.isFresh}">Tươi</span>-->
<!--              <span class="product-badge organic" th:if="${product.isOrganic}">Hữu cơ</span>-->
              <span class="product-badge discount" th:if="${product.discount > 0}" th:text="'-' + ${product.discount} + '%'">-20%</span>
            </div>

            <h1 class="product-title" th:text="${product.name}">Cà chua tươi hữu cơ</h1>

            <!-- Rating -->
            <div class="product-rating-section">
              <div class="rating-stars">
                <span th:each="i : ${#numbers.sequence(1, 5)}"
                      th:class="${i <= product.rating} ? 'star filled' : 'star'"
                      class="star">⭐</span>
              </div>
              <span class="rating-score" th:text="${product.rating}">4.5</span>
              <span class="rating-count" th:text="${product.ratingCount}">(24)</span>
            </div>

            <!-- Price -->
            <div class="price-section">
              <div class="current-price" th:text="'₫' + ${product.price}">₫45.000</div>
<!--              <div class="original-price" th:if="${product.originalPrice != product.price}" th:text="'₫' + ${product.originalPrice}">₫55.000</div>-->
              <div class="unit-info" th:text="'Đơn vị: ' + ${product.unitQuantity}">Đơn vị: 500g</div>
            </div>

            <!-- Product Description -->
            <div class="product-description">
              <p th:text="${product.description}">
                Cà chua tươi hữu cơ được trồng từ trang trại địa phương, không sử dụng hóa chất độc hại.
                Giàu vitamin C, lycopene và các chất chống oxi hóa tự nhiên, tốt cho sức khỏe.
              </p>
            </div>

            <!-- Product Details -->
            <div class="product-details">
              <h3>Thông tin sản phẩm</h3>
              <div class="details-grid">
                <div class="detail-item">
                  <span class="detail-label">Xuất xứ:</span>
                  <span class="detail-value" th:text="${product.origin}">Việt Nam</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Hạn sử dụng:</span>
                  <span class="detail-value" th:text="${product.expiryDate}">5-7 ngày</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Bảo quản:</span>
                  <span class="detail-value" th:text="${product.storage}">Nơi khô ráo, thoáng mát</span>
                </div>
              </div>
            </div>

            <!-- Add to Cart Section -->
            <div class="add-to-cart-section">
              <div class="quantity-selector">
                <label class="quantity-label">Số lượng:</label>
                <div class="quantity-controls">
                  <button class="qty-btn minus" type="button">-</button>
                  <input type="number" class="qty-input" value="1" min="1" max="99">
                  <button class="qty-btn plus" type="button">+</button>
                </div>
              </div>

              <div class="action-buttons">
                <button class="btn-add-to-cart">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <circle cx="9" cy="21" r="1" stroke="currentColor" stroke-width="2"/>
                    <circle cx="20" cy="21" r="1" stroke="currentColor" stroke-width="2"/>
                    <path d="m1 1 4 4h12l3 7H6" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Thêm vào giỏ hàng
                </button>

                <button class="btn-buy-now">Mua ngay</button>
              </div>

              <div class="secondary-actions">
                <button class="action-btn wishlist-btn">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Yêu thích
                </button>

                <button class="action-btn compare-btn">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M9 7h6v10H9V7z" stroke="currentColor" stroke-width="2"/>
                    <path d="M3 3h18v18H3V3z" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  So sánh
                </button>

                <button class="action-btn share-btn">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <circle cx="18" cy="5" r="3" stroke="currentColor" stroke-width="2"/>
                    <circle cx="6" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    <circle cx="18" cy="19" r="3" stroke="currentColor" stroke-width="2"/>
                    <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" stroke="currentColor" stroke-width="2"/>
                    <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Chia sẻ
                </button>
              </div>
            </div>

            <!-- Product Features -->
            <div class="product-features">
              <div class="feature-item">
                <div class="feature-icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/>
                  </svg>
                </div>
                <div class="feature-content">
                  <h4>Chất lượng cao</h4>
                  <p>Sản phẩm được chọn lọc kỹ càng</p>
                </div>
              </div>

              <div class="feature-item">
                <div class="feature-icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v11a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V8a1 1 0 0 0-1-1z" fill="currentColor"/>
                  </svg>
                </div>
                <div class="feature-content">
                  <h4>Giao hàng nhanh</h4>
                  <p>Giao hàng trong 24h</p>
                </div>
              </div>

              <div class="feature-item">
                <div class="feature-icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <div class="feature-content">
                  <h4>Đảm bảo chất lượng</h4>
                  <p>Hoàn tiền 100% nếu không hài lòng</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Product Tabs -->
        <div class="product-tabs-section">
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="description">Mô tả</button>
            <button class="tab-btn" data-tab="nutrition">Thành phần dinh dưỡng</button>
            <button class="tab-btn" data-tab="reviews">Đánh giá</button>
          </div>

          <div class="tab-content">
            <div class="tab-pane active" id="description">
              <h3>Mô tả sản phẩm</h3>
              <p th:text="${product.description}">
                Cà chua tươi hữu cơ là sản phẩm được trồng theo phương pháp hữu cơ hoàn toàn tự nhiên,
                không sử dụng thuốc trừ sâu hay phân bón hóa học. Với hương vị thơm ngon đặc trưng và
                giá trị dinh dưỡng cao, cà chua là nguyên liệu không thể thiếu trong bữa ăn hàng ngày.
              </p>
              <h4>Lợi ích sức khỏe:</h4>
              <ul>
                <li>Giàu vitamin C, tăng cường hệ miễn dịch</li>
                <li>Chứa lycopene, chống oxy hóa mạnh</li>
                <li>Hỗ trợ sức khỏe tim mạch</li>
                <li>Tốt cho làn da và thị lực</li>
              </ul>
            </div>

            <div class="tab-pane" id="nutrition">
              <h3>Thành phần dinh dưỡng (100g)</h3>
              <div class="nutrition-table">
                <div class="nutrition-row">
                  <span class="nutrition-label">Calories</span>
                  <span class="nutrition-value">18 kcal</span>
                </div>
                <div class="nutrition-row">
                  <span class="nutrition-label">Protein</span>
                  <span class="nutrition-value">0.9g</span>
                </div>
                <div class="nutrition-row">
                  <span class="nutrition-label">Carbohydrate</span>
                  <span class="nutrition-value">3.9g</span>
                </div>
                <div class="nutrition-row">
                  <span class="nutrition-label">Chất xơ</span>
                  <span class="nutrition-value">1.2g</span>
                </div>
                <div class="nutrition-row">
                  <span class="nutrition-label">Vitamin C</span>
                  <span class="nutrition-value">13.7mg</span>
                </div>
                <div class="nutrition-row">
                  <span class="nutrition-label">Lycopene</span>
                  <span class="nutrition-value">2.6mg</span>
                </div>
              </div>
            </div>

            <div class="tab-pane" id="reviews">
              <div class="reviews-summary">
                <div class="review-stats">
                  <div class="average-rating">
                    <span class="rating-number" th:text="${product.rating}">4.5</span>
                    <div class="rating-stars">
                      <span th:each="i : ${#numbers.sequence(1, 5)}"
                            th:class="${i <= product.rating} ? 'star filled' : 'star'"
                            class="star">⭐</span>
                    </div>
                    <span class="total-reviews" th:text="${product.ratingCount} + ' đánh giá'">24 đánh giá</span>
                  </div>
                </div>
              </div>

              <div class="reviews-list">
                <div class="review-item" th:each="review : ${product.reviews}">
                  <div class="review-header">
                    <div class="reviewer-info">
                      <span class="reviewer-name" th:text="${review.customerName}">Nguyễn Văn A</span>
                      <div class="review-rating">
                        <span th:each="i : ${#numbers.sequence(1, 5)}"
                              th:class="${i <= review.rating} ? 'star filled' : 'star'"
                              class="star">⭐</span>
                      </div>
                    </div>
                    <span class="review-date" th:text="${review.date}">15/07/2025</span>
                  </div>
                  <p class="review-content" th:text="${review.comment}">
                    Sản phẩm rất tươi ngon, giao hàng nhanh. Tôi sẽ mua lại!
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Related Products -->
        <div class="related-products-section">
          <h2 class="section-title">Sản phẩm liên quan</h2>
          <div class="related-products-grid">
            <div class="product-card" th:each="relatedProduct : ${relatedProducts}">
              <div class="product-image">
                <img th:src="@{${relatedProduct.image}}" th:alt="${relatedProduct.name}" class="product-img">
              </div>
              <div class="product-info">
                <h3 class="product-name" th:text="${relatedProduct.name}">Sản phẩm liên quan</h3>
                <div class="product-price">
                  <span class="current-price" th:text="'₫' + ${relatedProduct.price}">₫30.000</span>
                </div>
                <button class="add-to-cart-btn">Thêm vào giỏ</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <div th:replace="~{fragments/footer :: footer}"></div>

    <!-- Scripts -->
    <script th:src="@{/js/product-detail.js}"></script>
  </body>
</html>